<script>
	function handleUpdateButton(id_empresa) {
		console.log({
			body: JSON.stringify({
				cnpj: '09876543210987',//prompt('Informe o cnpj'),
				razaoSocial: 'MINIMO EIRELLI', //prompt('Informe a razao social'),
				nomeFantasia: 'Minimo Serviços',//prompt('Informe o nome fantasia'),
				site: 'www.minimo.com.br', //prompt('Informe o site'),
				email: 'empresa.minimo@gmail.com', //prompt('Informe o email'),
			})
		});

		const response = fetch(`/companies/${id_empresa}`, { 
			method: 'PUT',
			body: JSON.stringify({
				cnpj: '09876543210987',//prompt('Informe o cnpj'),
				razaoSocial: 'MINIMO EIRELLI', //prompt('Informe a razao social'),
				nomeFantasia: 'Minimo Serviços',//prompt('Informe o nome fantasia'),
				site: 'www.minimo.com.br', //prompt('Informe o site'),
				email: 'empresa.minimo@gmail.com', //prompt('Informe o email'),
			}),
		});

		if (response.status === 400) {
			alert('Ocorreu um erro');
		} else {
			alert('Sucesso!');
		}
	}

	function handleDeleteButton(id_empresa) {
		if (!confirm('Tem certeza disso?')) {
			return;
		}

		const response = fetch(`/companies/${id_empresa}`, { method: 'DELETE' });
		if (response.status === 400) {
			alert('Ocorreu um erro');
		} else {
			alert('Sucesso!');
			document.getElementById(`row:${id_empresa}`).remove();
		}
	}
</script>

<h1 style="text-align: center;">Empresas</h1>

<table class="table">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">CNPJ</th>
      <th scope="col">Razão Social</th>
      <th scope="col">Nome Fantasia</th>
			<th scope="col">Site</th>
			<th scope="col">Email</th>
			<th scope="col">Funções</th>
    </tr>
  </thead>
  <tbody>
		{{#each companies}}
			<tr id="row:{{this.idEmpresa}}">
				<th scope="row">{{this.idEmpresa}}</th>
				<td>{{this.cnpj}}</td>
				<td>{{this.razaoSocial}}</td>
				<td>{{this.nomeFantasia}}</td>
				<td>{{this.site}}</td>
				<td>{{this.email}}</td>
				<td>
					<div class="btn-group">
						<span>{{this.updateButton}}</span>
						<button onclick="handleUpdateButton({{this.idEmpresa}})" class="btn btn-success">Alterar</button>
						&nbsp;
						<button onclick="handleDeleteButton({{this.idEmpresa}})" class="btn btn-danger">Remover</button>
					</div>
				</td>
			</tr>
		{{/each }}
  </tbody>
</table>